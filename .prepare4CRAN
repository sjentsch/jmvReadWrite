# compare the files in inst/extdata (write and read again)
for (crrOMV in list.files('inst/extdata/')) {
    data = read_omv(file.path('inst/extdata/', crrOMV), sveAtt = TRUE);
    wrtDta = write_omv(data, 'Trial.omv');
    data2 = read_omv('Trial.omv', sveAtt = TRUE);
    cat(sprintf('\n\n%s\n', crrOMV));
    suppressWarnings(print(diffdf::diffdf(data, data2)));
    unlink('Trial.omv');
    rm('data', 'data2');
}

# REMEMBER: error messages from R are not always pointing to the place where the error occurs - especially when using commands like build_readme()

# checks the requirements (all dependencies up-to-date, etc.)
# use devtools::update_packages("devtools") and devtools::install_dev_deps() if required
devtools::dev_sitrep()

# do some initial checks
devtools::release_checks()

# update man-pages and NAMESPACE
devtools::spell_check()
devtools::check_man()

# building / updating README, PDF manual, and the HTML documentation
devtools::build_readme()
devtools::build_manual(path="doc")
pkgdown::clean_site()
pkgdown::build_site()
pkgdown::build_reference(run_dont_run = TRUE, preview = FALSE)
pkgdown::build_reference_index()

# check whether the examples run through and do some linting
devtools::run_examples(run_dontrun = TRUE)
devtools::lint()

# the package itself (tar.gz) - build() also builds vignettes
# ping-pong between build() and check() until all errors, warnings, notes are resolved 
devtools::build()
devtools::check(force_suggests = TRUE, incoming = TRUE, remote = TRUE, env_vars = c(NOT_CRAN = "FALSE"))

# the next stage of ping-pong, either build on the standard platforms
devtools::check_rhub()
# or builds it the package on rhub using all major platforms R is supported on
devtools::check_rhub(pkg = ".", platforms = rhub::platforms()$name, env_vars = c("_R_CHECK_FORCE_SUGGESTS_" = "false"))
# or, if there are known errors (e.g., on rhub), exclude certain platforms explicitly
crrPlt = rhub::platforms()
crrPlt = crrPlt[-c(x, ...)]
devtools::check_rhub(pkg = ".", platforms = crrPlt$name, env_vars = c("_R_CHECK_FORCE_SUGGESTS_" = "false"))

# check on win-builder
devtools::check_win_devel()

# now, we are ready to release the package onto CRAN
devtools::release()

# on the shell (after the submission got accepted):
V="v$(grep "^Version:" DESCRIPTION | cut -d: -f2 | sed -e 's/ //')"
git tag -a "${V}" $(tail -n 1 CRAN-RELEASE | cut -d\( -f2 | cut -d\) -f1 | sed 's/commit //') -m "CRAN submission: $(head -n1 CRAN-RELEASE | cut -c39-48)" -s && rm CRAN-RELEASE && git commit -a -m "Tagged CRAN-package on github and removed CRAN-RELEASE" && git push origin "${V}" 
# optional: Use the tag to create a release on GitHub

 
# for later - implement tests: ====================================================================
devtools::has_tests()
devtools::test()
devtools::test_active_file()
devtools::test_coverage_active_file()
devtools::test_coverage_file()
devtools::test_coverage()


# other helpful commands:
devtools::revdep()                    # shows reverse imports of the package
devtools::revdep_maintainers()        # ... and their maintainers
usethis::use_vignette('jmvReadWrite') # assigns a vignette
                                      # run this when getting "Setting active project to '<no active project>'" from build() or build_vignettes()
devtools::install_local()             # install locally from current working directory
devtools::uninstall()                 # ... and uninstall it
devtools::session_info()              # information regd. system and installed / loaded packages 
devtools::dev_packages()              # returns a vector with packages loaded by devtools - typically, the package that is actually developed
devtools::loaded_packages()           # shows currently loaded packages
devtools::load_all()                  # works approx. like using library()
devtools::update_packages()           # updates packages - unclear to what degree it is equivalent to update.packages()
