<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Merges two or more data files by adding the content of other input files as columns to the first input file and outputs them as files for the statistical spreadsheet 'jamovi' (https://www.jamovi.org) — merge_cols_omv • jmvReadWrite</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Merges two or more data files by adding the content of other input files as columns to the first input file and outputs them as files for the statistical spreadsheet 'jamovi' (https://www.jamovi.org) — merge_cols_omv"><meta name="description" content="Merges two or more data files by adding the content of other input files as columns to the first
input file and outputs them as files for the statistical spreadsheet 'jamovi'
(https://www.jamovi.org)"><meta property="og:description" content="Merges two or more data files by adding the content of other input files as columns to the first
input file and outputs them as files for the statistical spreadsheet 'jamovi'
(https://www.jamovi.org)"><meta property="og:image" content="https://sjentsch.github.io/jmvReadWrite/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">jmvReadWrite</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/jmvReadWrite.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sjentsch/jmvReadWrite/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Merges two or more data files by adding the content of other input files as columns to the first input file and outputs them as files for the statistical spreadsheet 'jamovi' (<a href="https://www.jamovi.org" class="external-link">https://www.jamovi.org</a>)</h1>
      <small class="dont-index">Source: <a href="https://github.com/sjentsch/jmvReadWrite/blob/main/R/merge_cols_omv.R" class="external-link"><code>R/merge_cols_omv.R</code></a></small>
      <div class="d-none name"><code>merge_cols_omv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Merges two or more data files by adding the content of other input files as columns to the first
input file and outputs them as files for the statistical spreadsheet 'jamovi'
(<a href="https://www.jamovi.org" class="external-link">https://www.jamovi.org</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">merge_cols_omv</span><span class="op">(</span></span>
<span>  dtaInp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fleOut <span class="op">=</span> <span class="st">""</span>,</span>
<span>  typMrg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"outer"</span>, <span class="st">"inner"</span>, <span class="st">"left"</span>, <span class="st">"right"</span><span class="op">)</span>,</span>
<span>  varBy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  varSrt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  psvAnl <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  usePkg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"foreign"</span>, <span class="st">"haven"</span><span class="op">)</span>,</span>
<span>  selSet <span class="op">=</span> <span class="st">""</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dtainp">dtaInp<a class="anchor" aria-label="anchor" href="#arg-dtainp"></a></dt>
<dd><p>Either a data frame (with the attribute "fleInp" containing the files to merge) or
vector with the names of the input files (including the path, if required;
"FILENAME.ext"; default: NULL); files can be of any supported file type, see
Details below</p></dd>


<dt id="arg-fleout">fleOut<a class="anchor" aria-label="anchor" href="#arg-fleout"></a></dt>
<dd><p>Name of the data file to be written (including the path, if required;
"FILE_OUT.omv"; default: ""); if empty, the resulting data frame is returned
instead</p></dd>


<dt id="arg-typmrg">typMrg<a class="anchor" aria-label="anchor" href="#arg-typmrg"></a></dt>
<dd><p>Type of merging operation: "outer" (default), "inner", "left" or "right"; see
Details below</p></dd>


<dt id="arg-varby">varBy<a class="anchor" aria-label="anchor" href="#arg-varby"></a></dt>
<dd><p>Name of the variable by which the data sets are matched, can either be a string,
a character or a list (see Details below; default: list())</p></dd>


<dt id="arg-varsrt">varSrt<a class="anchor" aria-label="anchor" href="#arg-varsrt"></a></dt>
<dd><p>Variable(s) that are used to sort the data frame (see Details; if empty, the order
after merging is kept; default: c())</p></dd>


<dt id="arg-psvanl">psvAnl<a class="anchor" aria-label="anchor" href="#arg-psvanl"></a></dt>
<dd><p>Whether analyses that are contained in the input file shall be transferred to the
output file (TRUE / FALSE; default: FALSE)</p></dd>


<dt id="arg-usepkg">usePkg<a class="anchor" aria-label="anchor" href="#arg-usepkg"></a></dt>
<dd><p>Name of the package: "foreign" or "haven" that shall be used to read SPSS, Stata
and SAS files; "foreign" is the default (it comes with base R), but "haven" is
newer and more comprehensive</p></dd>


<dt id="arg-selset">selSet<a class="anchor" aria-label="anchor" href="#arg-selset"></a></dt>
<dd><p>Name of the data set that is to be selected from the workspace (only applies when
reading .RData-files)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed on to methods; see Details below</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a data frame (only returned if <code>fleOut</code> is empty) where the columns of all input data
sets (given in the <code>dtaInp</code>-argument) are concatenated</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<ul><li><p>Using data frames with the input parameter <code>dtaInp</code> is primarily thought to be used when
calling <code>merge_cols_omv</code> from the jamovi-modules <code>jTransform</code> and <code>Rj</code>. For the use in R, it
is strongly recommended to use a character vector with the file names instead.</p></li>
<li><p>There are four different types of merging operations (defined via <code>typMrg</code>): "outer" keeps all
cases (but columns in the resulting data set may contain empty cells / missing values if same
input data sets did not have a row containing the matching variable (defined in <code>varBy</code>).
"inner" keeps only those cases where all datasets contain the same value in the matching
variable, for "left" all cases from the first data set in <code>dtaInp</code> are kept (whereas cases
that are only contained in the second or any later input data set are dropped), for "right"
all cases from the second (or any higher) data set in <code>dtaInp</code> are kept. The behaviour of
"left" and "right" may be somewhat difficult to predict in case of merging several data sets,
therefore "outer" might be a safer choice if several data sets are merged.</p></li>
<li><p>The variable that is used for matching (<code>varBy</code>) can either be a string (if all datasets
contain a matching variable with the same name), a character vector (containing more than one
matching variables that are contained in / the same for all data sets) or a list with the same
length as dtaInp. In such list, each cell can again contain either a string (one matching
variable for each data set in dtaInp) or a character vector (several matching variables for
each data set in dtaInp; NB: all character vectors in the cells of the list must have the same
length as it is necessary to always use the same number of matching variables when merging).</p></li>
<li><p><code>varSrt</code> can be either a character or a character vector (with one or more variables
respectively). The sorting order for a particular variable can be inverted with preceding the
variable name with "-". Please note that this doesn't make sense and hence throws a warning
for certain variable types (e.g., factors).</p></li>
<li><p>The ellipsis-parameter (<code>...</code>) can be used to submit arguments / parameters to the functions
that are used for transforming or reading the data. By clicking on the respective function
under “See also”, you can get a more detailed overview over which parameters each of those
functions take.</p></li>
<li><p>Adding columns uses <code>merge</code>. <code>typMrg</code> is implemented by setting <code>TRUE</code> or <code>FALSE</code> to <code>all.x</code>
and <code>all.y</code> in <code>merge</code>, <code>varBy</code> matches <code>by.x</code> and <code>by.y</code>. The help for <code>merge</code> can be
accessed by clicking on the link under “See also”.</p></li>
<li><p>The functions for reading and writing the data are: <code>read_omv</code> and <code>write_omv</code> (for
jamovi-files), <code>read.table</code> (for CSV / TSV files; using similar defaults as <code>read.csv</code> for CSV
and <code>read.delim</code> for TSV which both are based upon <code>read.table</code>), <code>load</code> (for .RData-files),
<code>readRDS</code> (for .rds-files), <code>read_sav</code> (needs R-package <code>haven</code>) or <code>read.spss</code> (needs
R-package <code>foreign</code>) for SPSS-files, <code>read_dta</code> (<code>haven</code>) / <code>read.dta</code> (<code>foreign</code>) for
Stata-files, <code>read_sas</code> (<code>haven</code>) for SAS-data-files, and <code>read_xpt</code> (<code>haven</code>) / <code>read.xport</code>
(<code>foreign</code>) for SAS-transport-files. If you would like to use <code>haven</code>, you may need to install
it using <code>install.packages("haven", dep = TRUE)</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>merge_cols_omv</code> internally uses the following functions: Adding columns uses
<code><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge()</a></code>. For reading and writing data files in different formats: <code><a href="read_omv.html">read_omv()</a></code>
and <code><a href="write_omv.html">write_omv()</a></code> for jamovi-files, <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">utils::read.table()</a></code> for CSV / TSV files,
<code><a href="https://rdrr.io/r/base/load.html" class="external-link">load()</a></code> for reading .RData-files, <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS()</a></code> for .rds-files, <code><a href="https://haven.tidyverse.org/reference/read_spss.html" class="external-link">haven::read_sav()</a></code> or
<code><a href="https://rdrr.io/pkg/foreign/man/read.spss.html" class="external-link">foreign::read.spss()</a></code> for SPSS-files, <code><a href="https://haven.tidyverse.org/reference/read_dta.html" class="external-link">haven::read_dta()</a></code> or <code><a href="https://rdrr.io/pkg/foreign/man/read.dta.html" class="external-link">foreign::read.dta()</a></code> for
Stata-files, <code><a href="https://haven.tidyverse.org/reference/read_sas.html" class="external-link">haven::read_sas()</a></code> for SAS-data-files, and <code><a href="https://haven.tidyverse.org/reference/read_xpt.html" class="external-link">haven::read_xpt()</a></code> or
<code><a href="https://rdrr.io/pkg/foreign/man/read.xport.html" class="external-link">foreign::read.xport()</a></code> for SAS-transport-files.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">dtaInp</span> <span class="op">&lt;-</span> <span class="fu">jmvReadWrite</span><span class="fu">::</span><span class="va"><a href="bfi_sample2.html">bfi_sample2</a></span></span></span>
<span class="r-in"><span><span class="va">nmeInp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">".rds"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nmeOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".omv"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">nmeInp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">dtaInp</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dtaInp</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"_"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="va">nmeInp</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># save dtaInp three times (i.e., the length of nmeInp), adding "_" + 1 ... 3 as index</span></span></span>
<span class="r-in"><span><span class="co"># to the data variables (A1 ... O5, gender, age → A1_1, ...)</span></span></span>
<span class="r-in"><span><span class="fu">jmvReadWrite</span><span class="fu">::</span><span class="fu">merge_cols_omv</span><span class="op">(</span>dtaInp <span class="op">=</span> <span class="va">nmeInp</span>, fleOut <span class="op">=</span> <span class="va">nmeOut</span>, varBy <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.info.html" class="external-link">file.info</a></span><span class="op">(</span><span class="va">nmeOut</span><span class="op">)</span><span class="op">$</span><span class="va">size</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># -&gt; 17731 (size may differ on different OSes)</span></span></span>
<span class="r-in"><span><span class="va">dtaOut</span> <span class="op">&lt;-</span> <span class="fu">jmvReadWrite</span><span class="fu">::</span><span class="fu"><a href="read_omv.html">read_omv</a></span><span class="op">(</span><span class="va">nmeOut</span>, sveAtt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># read the data set where the three original datasets were added as columns and show</span></span></span>
<span class="r-in"><span><span class="co"># the variable names</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dtaOut</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dtaInp</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># compared to the input data set, we have the same names (expect for "ID" which was</span></span></span>
<span class="r-in"><span><span class="co"># used for matching and that each variable had added an indicator from which data</span></span></span>
<span class="r-in"><span><span class="co"># set they came)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">dtaInp</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">dtaOut</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># the first dimension of the data sets (rows) stayed the same (250), whereas the</span></span></span>
<span class="r-in"><span><span class="co"># second dimension is now approx. three times as large (28 -&gt; 82):</span></span></span>
<span class="r-in"><span><span class="co"># 28 - 1 (for "ID") = 27 * 3 + 1 (for "ID") = 82</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">dtaInp</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">dtaOut</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># it's therefore not much surprise that the values of the column means for the first</span></span></span>
<span class="r-in"><span><span class="co"># 10 variables of dtaInp and dtaOut are the same too</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">nmeInp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">nmeOut</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Jentschke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

